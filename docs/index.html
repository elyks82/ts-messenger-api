<!doctype html>
<html class="default no-js">
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>Facebook Messenger API - v0.4.0</title>
	<meta name="description" content="Documentation for Facebook Messenger API - v0.4.0">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="stylesheet" href="assets/css/main.css">
	<script async src="assets/js/search.js" id="search-script"></script>
</head>
<body>
<header>
	<div class="tsd-page-toolbar">
		<div class="container">
			<div class="table-wrap">
				<div class="table-cell" id="tsd-search" data-index="assets/js/search.json" data-base=".">
					<div class="field">
						<label for="tsd-search-field" class="tsd-widget search no-caption">Search</label>
						<input id="tsd-search-field" type="text" />
					</div>
					<ul class="results">
						<li class="state loading">Preparing search index...</li>
						<li class="state failure">The search index is not available</li>
					</ul>
					<a href="index.html" class="title">Facebook Messenger API - v0.4.0</a>
				</div>
				<div class="table-cell" id="tsd-widgets">
					<div id="tsd-filter">
						<a href="#" class="tsd-widget options no-caption" data-toggle="options">Options</a>
						<div class="tsd-filter-group">
							<div class="tsd-select" id="tsd-filter-visibility">
								<span class="tsd-select-label">All</span>
								<ul class="tsd-select-list">
									<li data-value="public">Public</li>
									<li data-value="protected">Public/Protected</li>
									<li data-value="private" class="selected">All</li>
								</ul>
							</div>
							<input type="checkbox" id="tsd-filter-inherited" checked />
							<label class="tsd-widget" for="tsd-filter-inherited">Inherited</label>
							<input type="checkbox" id="tsd-filter-externals" checked />
							<label class="tsd-widget" for="tsd-filter-externals">Externals</label>
						</div>
					</div>
					<a href="#" class="tsd-widget menu no-caption" data-toggle="menu">Menu</a>
				</div>
			</div>
		</div>
	</div>
	<div class="tsd-page-title">
		<div class="container">
			<h1>Facebook Messenger API - v0.4.0</h1>
		</div>
	</div>
</header>
<div class="container container-main">
	<div class="row">
		<div class="col-8 col-content">
			<div class="tsd-panel tsd-typography">
				<a href="#ts-messenger-api" id="ts-messenger-api" style="color: inherit; text-decoration: none;">
					<h1>ts-messenger-api</h1>
				</a>
				<p>Unofficial API for Facebook Messenger. This package provides programmatic access to Facebook Messenger activity like sending and receiving messages on behalf of actual user.</p>
				<blockquote>
					<p>⚠ <strong>Note:</strong> <em>This package works only on <strong>NodeJS v15</strong> and higher!</em></p>
				</blockquote>
				<blockquote>
					<p>Since Facebook makes frequent modification to their API, please bear in mind, that this library is prone to developing bugs, that may not be immediately fixed.</p>
				</blockquote>
				<a href="#quick-demo" id="quick-demo" style="color: inherit; text-decoration: none;">
					<h2>Quick Demo</h2>
				</a>
				<pre><code class="language-ts"><span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">facebookLogin</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;ts-messenger-api&#039;</span><span style="color: #000000">;</span>
<span style="color: #008000">// for plain JavaScript use this:</span>
<span style="color: #008000">// const facebookLogin = require(&#039;ts-messenger-api&#039;).default;</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">api</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">facebookLogin</span><span style="color: #000000">({</span>
<span style="color: #000000">    </span><span style="color: #001080">email:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;your.email@example.com&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">    </span><span style="color: #001080">password:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;your_messenger_password&#039;</span>
<span style="color: #000000">});</span>

<span style="color: #0000FF">const</span><span style="color: #000000"> </span><span style="color: #0070C1">friends</span><span style="color: #000000"> = </span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">getFriendsList</span><span style="color: #000000">();</span>

<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">listen</span><span style="color: #000000">();</span>
<span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">sendMessage</span><span style="color: #000000">({ </span><span style="color: #001080">body:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;Hi&#039;</span><span style="color: #000000"> }, </span><span style="color: #001080">friends</span><span style="color: #000000">[</span><span style="color: #098658">0</span><span style="color: #000000">].</span><span style="color: #001080">id</span><span style="color: #000000">);</span>
</code></pre>
				<a href="#message-sending" id="message-sending" style="color: inherit; text-decoration: none;">
					<h2>Message Sending</h2>
				</a>
				<p>There are some examples of sending messages below. First of all, start with <code>await api.listen();</code> to establish a websocket connection.</p>
				<a href="#plain-text-message" id="plain-text-message" style="color: inherit; text-decoration: none;">
					<h3>Plain text message</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">sendMessage</span><span style="color: #000000">({ </span><span style="color: #001080">body:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;This&#039;</span><span style="color: #000000"> }, </span><span style="color: #001080">friends</span><span style="color: #000000">[</span><span style="color: #098658">3</span><span style="color: #000000">].</span><span style="color: #001080">id</span><span style="color: #000000">);</span>
</code></pre>
				<a href="#attachment-message" id="attachment-message" style="color: inherit; text-decoration: none;">
					<h3>Attachment message</h3>
				</a>
				<p>Facebook automatically recognises file type (picture, video, audio or general file).</p>
				<pre><code class="language-typescript"><span style="color: #AF00DB">import</span><span style="color: #000000"> </span><span style="color: #001080">fs</span><span style="color: #000000"> </span><span style="color: #AF00DB">from</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;fs&#039;</span><span style="color: #000000">;</span>
<span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">sendMessage</span><span style="color: #000000">({ </span><span style="color: #001080">attachment:</span><span style="color: #000000"> </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">createReadStream</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;path-to-file&#039;</span><span style="color: #000000">) }, </span><span style="color: #001080">friends</span><span style="color: #000000">[</span><span style="color: #098658">3</span><span style="color: #000000">].</span><span style="color: #001080">id</span><span style="color: #000000">);</span>
<span style="color: #008000">// or send multiple attachments in one message</span>
<span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">sendMessage</span><span style="color: #000000">(</span>
<span style="color: #000000">    {</span>
<span style="color: #000000">        </span><span style="color: #001080">attachment:</span><span style="color: #000000"> [</span>
<span style="color: #000000">            </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">createReadStream</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;path-to-file1&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">            </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">createReadStream</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;path-to-file2&#039;</span><span style="color: #000000">),</span>
<span style="color: #000000">            </span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">createReadStream</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;path-to-file3&#039;</span><span style="color: #000000">)</span>
<span style="color: #000000">        ]</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">friends</span><span style="color: #000000">[</span><span style="color: #098658">3</span><span style="color: #000000">].</span><span style="color: #001080">id</span>
<span style="color: #000000">);</span>
</code></pre>
				<a href="#replying-to-a-message" id="replying-to-a-message" style="color: inherit; text-decoration: none;">
					<h3>Replying to a message</h3>
				</a>
				<pre><code class="language-typescript"><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">sendMessage</span><span style="color: #000000">(</span>
<span style="color: #000000">    {</span>
<span style="color: #000000">        </span><span style="color: #001080">body:</span><span style="color: #000000"> </span><span style="color: #A31515">&#039;This is my reply to your question&#039;</span><span style="color: #000000">,</span>
<span style="color: #000000">        </span><span style="color: #001080">replyToMessage:</span><span style="color: #000000"> </span><span style="color: #001080">originalMessageId</span>
<span style="color: #000000">    },</span>
<span style="color: #000000">    </span><span style="color: #001080">friends</span><span style="color: #000000">[</span><span style="color: #098658">3</span><span style="color: #000000">].</span><span style="color: #001080">id</span>
<span style="color: #000000">);</span>
</code></pre>
				<p>Similarly, you can send a message with mentions. The types for that are in the docs.</p>
				<a href="#receiving-messages-and-events" id="receiving-messages-and-events" style="color: inherit; text-decoration: none;">
					<h2>Receiving messages and events</h2>
				</a>
				<p>First of all, start with <code>await api.listen()</code> to establish a websocket connection.
					You can access the <code>EventEmitter</code> by using the returned value of this function
				or get it directly from <code>api.listener</code> property.</p>
				<p>Posible event types are:</p>
				<ul>
					<li><code>&quot;message&quot;</code> for all incoming messages and events (for listening to events,
					specify the <code>options</code> argument as <code>{listenEvents: true}</code> while login)</li>
					<li><code>&quot;presence&quot;</code> for information about friends&#39; active state</li>
					<li><code>&quot;typ&quot;</code> for incoming typing indicators</li>
					<li><code>&quot;error&quot;</code> for possible errors caused by websocket communication</li>
				</ul>
				<pre><code class="language-typescript"><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #001080">listener</span><span style="color: #000000">.</span><span style="color: #795E26">addEventListener</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;message&#039;</span><span style="color: #000000">, (</span><span style="color: #001080">msg</span><span style="color: #000000">: </span><span style="color: #267F99">AnyIncomingMessage</span><span style="color: #000000">) </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">log</span><span style="color: #000000">(</span><span style="color: #001080">msg</span><span style="color: #000000">));</span>
<span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #001080">listener</span><span style="color: #000000">.</span><span style="color: #795E26">addEventListener</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;error&#039;</span><span style="color: #000000">, </span><span style="color: #001080">err</span><span style="color: #000000"> </span><span style="color: #0000FF">=&gt;</span><span style="color: #000000"> </span><span style="color: #001080">console</span><span style="color: #000000">.</span><span style="color: #795E26">error</span><span style="color: #000000">(</span><span style="color: #001080">err</span><span style="color: #000000">));</span>
</code></pre>
				<blockquote>
					<p>Type of an incoming message is defined in <code>msg.type</code>.</p>
				</blockquote>
				<a href="#login-with-appstate" id="login-with-appstate" style="color: inherit; text-decoration: none;">
					<h2>Login with <code>AppState</code></h2>
				</a>
				<p>You can login to Facebook account for the second time without the need to provide login
					credentials (email and password). This feature is provided with <code>AppState</code> (array of
					cookies provided by Facebook). We advise you to save the AppState right after first
				successful login using:</p>
				<pre><code class="language-typescript"><span style="color: #008000">// after first login</span>
<span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">writeFileSync</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./appState.json&#039;</span><span style="color: #000000">, </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">stringify</span><span style="color: #000000">(</span><span style="color: #001080">api</span><span style="color: #000000">.</span><span style="color: #795E26">getAppState</span><span style="color: #000000">()));</span>
</code></pre>
				<p>Now you can use the saved cookies to log in later.</p>
				<pre><code class="language-typescript"><span style="color: #008000">// using the saved AppState</span>
<span style="color: #0000FF">let</span><span style="color: #000000"> </span><span style="color: #001080">api</span><span style="color: #000000">: </span><span style="color: #267F99">Api</span><span style="color: #000000"> | </span><span style="color: #267F99">null</span><span style="color: #000000"> = </span><span style="color: #0000FF">null</span><span style="color: #000000">;</span>
<span style="color: #AF00DB">try</span><span style="color: #000000"> {</span>
<span style="color: #000000">    </span><span style="color: #001080">api</span><span style="color: #000000"> = (</span><span style="color: #AF00DB">await</span><span style="color: #000000"> </span><span style="color: #795E26">login</span><span style="color: #000000">(</span>
<span style="color: #000000">        {</span>
<span style="color: #000000">            </span><span style="color: #001080">appState:</span><span style="color: #000000"> </span><span style="color: #267F99">JSON</span><span style="color: #000000">.</span><span style="color: #795E26">parse</span><span style="color: #000000">(</span><span style="color: #001080">fs</span><span style="color: #000000">.</span><span style="color: #795E26">readFileSync</span><span style="color: #000000">(</span><span style="color: #A31515">&#039;./appState.json&#039;</span><span style="color: #000000">).</span><span style="color: #795E26">toString</span><span style="color: #000000">())</span>
<span style="color: #000000">        },</span>
<span style="color: #000000">        { </span><span style="color: #001080">listenEvents:</span><span style="color: #000000"> </span><span style="color: #0000FF">true</span><span style="color: #000000"> }</span>
<span style="color: #000000">    )) </span><span style="color: #AF00DB">as</span><span style="color: #000000"> </span><span style="color: #267F99">Api</span><span style="color: #000000">;</span>
<span style="color: #000000">} </span><span style="color: #AF00DB">catch</span><span style="color: #000000"> (</span><span style="color: #001080">error</span><span style="color: #000000">) {</span>
<span style="color: #000000">    </span><span style="color: #008000">// something like `console.error(error);`</span>
<span style="color: #000000">}</span>
</code></pre>
				<a href="#docs" id="docs" style="color: inherit; text-decoration: none;">
					<h2>Docs</h2>
				</a>
				<p>You can find the documentation <a href="https://makiprogrammer.github.io/ts-messenger-api/index.html">here</a>.</p>
				<a href="#features" id="features" style="color: inherit; text-decoration: none;">
					<h2>Features</h2>
				</a>
				<p>The following table lists all features that are implemented or are destined to be implemented in the future. If you would like to have some feature implemented do not hesitate to submit PR.</p>
				<table>
					<thead>
						<tr>
							<th>Feature</th>
							<th align="center">Implemented</th>
						</tr>
					</thead>
					<tbody><tr>
							<td>Login</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Logout</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Get app state</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td><strong>Messages</strong></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Send message</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Unsend message</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Delete message</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Forward attachment</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Set message reaction</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Send typing indicator</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td><strong>Users</strong></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Get friends list</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Get user ID</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Get user info</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td><strong>Threads</strong></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Get thread list</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Get thread info</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Get thread history</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Get thread pictures</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Delete thread</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Mute thread</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Search for thread</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td><strong>Customisation</strong></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Change thread colour</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Change thread emoji</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td><strong>Group management</strong></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Add user to group</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Remove user from group</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Leave group</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Change admin status</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Change group image</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Change group title</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Change nickname</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Create poll</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Mark as read</td>
							<td align="center">✔</td>
						</tr>
						<tr>
							<td>Mark as read all</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td></td>
							<td align="center"></td>
						</tr>
						<tr>
							<td>Change archived status</td>
							<td align="center">❌</td>
						</tr>
						<tr>
							<td>Change blocked status</td>
							<td align="center">❌</td>
						</tr>
				</tbody></table>
			</div>
		</div>
		<div class="col-4 col-menu menu-sticky-wrap menu-highlight">
			<nav class="tsd-navigation primary">
				<ul>
					<li class=" ">
						<a href="modules.html">Modules</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/api.html">api</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/types.html">types</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/types_incomingmessages.html">types/incoming<wbr>Messages</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/types_threads.html">types/threads</a>
					</li>
					<li class=" tsd-kind-module">
						<a href="modules/types_users.html">types/users</a>
					</li>
				</ul>
			</nav>
			<nav class="tsd-navigation secondary menu-sticky">
				<ul class="before-current">
				</ul>
			</nav>
		</div>
	</div>
</div>
<footer>
	<div class="container">
		<h2>Legend</h2>
		<div class="tsd-legend-group">
			<ul class="tsd-legend">
				<li class="tsd-kind-type-alias"><span class="tsd-kind-icon">Type alias</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-enum"><span class="tsd-kind-icon">Enumeration</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-interface"><span class="tsd-kind-icon">Interface</span></li>
			</ul>
			<ul class="tsd-legend">
				<li class="tsd-kind-class"><span class="tsd-kind-icon">Class</span></li>
			</ul>
		</div>
	</div>
</footer>
<div class="overlay"></div>
<script src="assets/js/main.js"></script>
</body>
</html>